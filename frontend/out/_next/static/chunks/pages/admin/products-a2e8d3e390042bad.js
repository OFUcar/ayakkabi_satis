(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[209],{2678:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/products",function(){return a(5643)}])},2470:function(e,t,a){"use strict";var n=a(5893),i=a(7294),r=a(8539),s=a(6788),l=a(3379),o=a(5770),c=a(7638),d=a(2200),h=a(4291),x=a(990),u=a(6912),m=a(4237),p=a(6795),j=a(2857),f=a(7958),g=a(18),Z=a(1220),y=a(3246),b=a(9129),k=a(5854),w=a(3837),v=a(5413),C=a(5861),S=a(1897),P=a(899),z=a(1664),N=a.n(z),E=a(5482);let T=[{text:"Dashboard",icon:(0,n.jsx)(g.Z,{}),path:"/admin"},{text:"E-Ticaret",icon:(0,n.jsx)(Z.Z,{}),subItems:[{text:"\xdcr\xfcnler",path:"/admin/products"},{text:"Siparişler",path:"/admin/orders"},{text:"Kategoriler",path:"/admin/categories"},{text:"Y\xf6netim Paneli",path:"/admin"}]},{text:"Kullanıcılar",icon:(0,n.jsx)(y.Z,{}),path:"/admin/users"},{text:"Raporlar",icon:(0,n.jsx)(b.Z,{}),path:"/admin/reports"},{text:"Ayarlar",icon:(0,n.jsx)(k.Z,{}),path:"/admin/settings"}];t.Z=e=>{let{children:t,pageTitle:a}=e,[g,Z]=(0,i.useState)(!1),[y,b]=(0,i.useState)(null),{signOut:k}=(0,E.a)(),z=()=>{Z(!g)},W=e=>{b(y===e?null:e)},A=(0,n.jsxs)("div",{children:[(0,n.jsx)(r.Z,{children:(0,n.jsx)(s.Z,{variant:"h6",noWrap:!0,component:"div",sx:{fontWeight:600},children:"Y\xf6netim Paneli"})}),(0,n.jsx)(l.Z,{children:T.map((e,t)=>(0,n.jsx)(i.Fragment,{children:e.subItems?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(o.ZP,{button:!0,onClick:()=>W(e.text),children:[(0,n.jsx)(c.Z,{children:e.icon}),(0,n.jsx)(d.Z,{primary:e.text}),y===e.text?(0,n.jsx)(w.Z,{}):(0,n.jsx)(v.Z,{})]}),(0,n.jsx)(h.Z,{in:y===e.text,timeout:"auto",unmountOnExit:!0,children:(0,n.jsx)(l.Z,{component:"div",disablePadding:!0,children:e.subItems.map(e=>(0,n.jsx)(N(),{href:e.path,passHref:!0,legacyBehavior:!0,children:(0,n.jsx)(o.ZP,{button:!0,component:"a",sx:{pl:4},children:(0,n.jsx)(d.Z,{primary:e.text})})},e.text))})})]}):(0,n.jsx)(N(),{href:e.path,passHref:!0,legacyBehavior:!0,children:(0,n.jsxs)(o.ZP,{button:!0,component:"a",children:[(0,n.jsx)(c.Z,{children:e.icon}),(0,n.jsx)(d.Z,{primary:e.text})]})})},e.text))}),(0,n.jsxs)(x.Z,{sx:{position:"absolute",bottom:0,width:"100%"},children:[(0,n.jsx)(u.Z,{}),(0,n.jsx)(N(),{href:"/",passHref:!0,legacyBehavior:!0,children:(0,n.jsxs)(o.ZP,{button:!0,component:"a",children:[(0,n.jsx)(c.Z,{children:(0,n.jsx)(C.Z,{})}),(0,n.jsx)(d.Z,{primary:"Ana Sayfaya D\xf6n"})]})}),(0,n.jsx)(u.Z,{}),(0,n.jsxs)(o.ZP,{button:!0,onClick:k,children:[(0,n.jsx)(c.Z,{children:(0,n.jsx)(S.Z,{})}),(0,n.jsx)(d.Z,{primary:"\xc7ıkış Yap"})]})]})]});return(0,n.jsxs)(x.Z,{sx:{display:"flex"},children:[(0,n.jsx)(m.ZP,{}),(0,n.jsx)(p.Z,{position:"fixed",sx:{width:{sm:"calc(100% - ".concat(240,"px)")},ml:{sm:"".concat(240,"px")},bgcolor:"background.paper",color:"text.primary",boxShadow:"0 1px 4px rgba(0,0,0,0.1)"},children:(0,n.jsxs)(r.Z,{children:[(0,n.jsx)(j.Z,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:z,sx:{mr:2,display:{sm:"none"}},children:(0,n.jsx)(P.Z,{})}),(0,n.jsx)(s.Z,{variant:"h6",noWrap:!0,component:"div",children:a||"Dashboard"})]})}),(0,n.jsxs)(x.Z,{component:"nav",sx:{width:{sm:240},flexShrink:{sm:0}},children:[(0,n.jsx)(f.ZP,{variant:"temporary",open:g,onClose:z,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:240}},children:A}),(0,n.jsx)(f.ZP,{variant:"permanent",sx:{display:{xs:"none",sm:"block"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:240}},open:!0,children:A})]}),(0,n.jsxs)(x.Z,{component:"main",sx:{flexGrow:1,p:3,width:{sm:"calc(100% - ".concat(240,"px)")},bgcolor:"#f4f6f8",minHeight:"100vh"},children:[(0,n.jsx)(r.Z,{}),t]})]})}},5643:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return O}});var n=a(5893),i=a(7294),r=a(5895),s=a(990),l=a(3539),o=a(6788),c=a(2857),d=a(7182),h=a(4723),x=a(4677),u=a(3453),m=a(2365),p=a(110),j=a(6541),f=a(6727),g=a(3977),Z=a(9265),y=a(1313),b=a(9090),k=a(3839),w=a(2470),v=a(8573),C=a(6897),S=a(8649),P=a(9346),z=a(5972),N=a(6307),E=a(1873),T=a(2612),W=a(8444),A=a(8074);a(198),a(6650);var B=e=>{let{open:t,onClose:a,onSave:r,product:l}=e,[d,h]=(0,i.useState)({}),[g,Z]=(0,i.useState)([]),[y,b]=(0,i.useState)([]),[k,w]=(0,i.useState)([]),[B,D]=(0,i.useState)(l&&l.model||""),[F,O]=(0,i.useState)({});(0,i.useEffect)(()=>{t&&(async()=>{try{let e=await fetch("http://localhost:5000/api/categories"),t=await fetch("http://localhost:5000/api/brands");e.ok&&b(await e.json()),t.ok&&w(await t.json())}catch(e){console.error("Kategori/Marka verisi \xe7ekilemedi:",e)}})()},[t]),(0,i.useEffect)(()=>{l?(h({...l,sizes:l.sizes||[]}),Z(l.images||[]),D(l.model||""),O(l.stock||{})):(h({name:"",sku:"",price:"",description:"",category:"",brand:"",sizes:[]}),Z([]),D(""),O({}))},[l,t]);let I=e=>{let{name:t,value:a}=e.target;h(e=>({...e,[t]:a}))},{getRootProps:_,getInputProps:K,isDragActive:U}=(0,A.uI)({onDrop:e=>{if(g.length+e.length>15){alert("En fazla 15 fotoğraf y\xfckleyebilirsiniz.");return}Z(t=>[...t,...e])},accept:{"image/*":[]},multiple:!0,maxFiles:15}),M=e=>{Z(g.filter((t,a)=>a!==e))},R=async e=>{try{let t=e.map(async e=>{if("string"==typeof e)return e;if(e instanceof File){let t=new FormData;t.append("image",e);let a=await fetch("http://localhost:5000/api/upload/upload-image-local",{method:"POST",body:t});if(!a.ok)throw Error("Dosya y\xfckleme hatası: ".concat(a.statusText));return(await a.json()).imageUrl}return null});return(await Promise.all(t)).filter(Boolean)}catch(e){throw console.error("Dosya y\xfckleme hatası:",e),Error("Dosyalar y\xfcklenirken bir hata oluştu. L\xfctfen tekrar deneyin.")}},Y=(e,t)=>{O(a=>({...a,[e]:t}))},H=async()=>{let e=await R(g);r({...d,price:Number(d.price),images:e,model:B,stock:F})};return(0,n.jsxs)(u.Z,{open:t,onClose:a,maxWidth:"md",fullWidth:!0,children:[(0,n.jsx)(m.Z,{children:l?"\xdcr\xfcn\xfc D\xfczenle":"Yeni \xdcr\xfcn Ekle"}),(0,n.jsx)(p.Z,{children:(0,n.jsxs)(v.ZP,{container:!0,spacing:3,sx:{mt:1},children:[(0,n.jsxs)(v.ZP,{item:!0,xs:12,md:6,children:[(0,n.jsx)(j.Z,{label:"\xdcr\xfcn Adı",name:"name",value:d.name||"",onChange:I,fullWidth:!0,margin:"dense"}),(0,n.jsx)(j.Z,{label:"\xdcr\xfcn Kodu (SKU)",name:"sku",value:d.sku||"",onChange:I,fullWidth:!0,margin:"dense"}),(0,n.jsx)(v.ZP,{container:!0,spacing:2,children:(0,n.jsx)(v.ZP,{item:!0,xs:12,children:(0,n.jsx)(j.Z,{label:"Fiyat",name:"price",type:"number",value:d.price,onChange:I,fullWidth:!0,margin:"dense",inputProps:{min:0}})})}),(0,n.jsxs)(C.Z,{fullWidth:!0,margin:"dense",children:[(0,n.jsx)(S.Z,{children:"Kategori"}),(0,n.jsx)(P.Z,{name:"category",value:d.category||"",onChange:I,label:"Kategori",children:y.map(e=>(0,n.jsx)(z.Z,{value:e.name,children:e.name},e.id))})]}),(0,n.jsx)(j.Z,{label:"Marka",name:"brand",value:d.brand||"",onChange:I,fullWidth:!0,margin:"dense"}),(0,n.jsx)(j.Z,{label:"Model",name:"model",value:B,onChange:e=>D(e.target.value),fullWidth:!0,margin:"dense"}),(0,n.jsxs)(C.Z,{fullWidth:!0,margin:"dense",children:[(0,n.jsx)(S.Z,{children:"Cinsiyet"}),(0,n.jsxs)(P.Z,{name:"gender",value:d.gender||"",onChange:I,label:"Cinsiyet",children:[(0,n.jsx)(z.Z,{value:"Erkek",children:"Erkek"}),(0,n.jsx)(z.Z,{value:"Kadın",children:"Kadın"}),(0,n.jsx)(z.Z,{value:"Unisex",children:"Unisex"}),(0,n.jsx)(z.Z,{value:"\xc7ocuk",children:"\xc7ocuk"})]})]}),(0,n.jsxs)(C.Z,{fullWidth:!0,margin:"dense",children:[(0,n.jsx)(S.Z,{children:"Bedenler"}),(0,n.jsx)(P.Z,{name:"sizes",multiple:!0,value:d.sizes||[],onChange:e=>{let{target:{value:t}}=e;h(e=>({...e,sizes:"string"==typeof t?t.split(","):t}))},input:(0,n.jsx)(N.Z,{label:"Bedenler"}),renderValue:e=>(0,n.jsx)(s.Z,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map(e=>(0,n.jsx)(E.Z,{label:e},e))}),children:[...Array(16)].map((e,t)=>{let a=30+t;return(0,n.jsx)(z.Z,{value:a,children:a},a)})})]}),(d.sizes||[]).length>0&&(0,n.jsxs)(s.Z,{sx:{mt:1},children:[(0,n.jsx)(o.Z,{variant:"subtitle2",children:"Her Beden İ\xe7in Stok"}),(0,n.jsx)(v.ZP,{container:!0,spacing:1,children:d.sizes.map(e=>(0,n.jsx)(v.ZP,{item:!0,xs:4,sm:3,md:2,children:(0,n.jsx)(j.Z,{label:"Stok (".concat(e,")"),type:"number",value:F[e]||"",onChange:t=>Y(e,Number(t.target.value)),fullWidth:!0,margin:"dense",inputProps:{min:0}})},e))})]}),(0,n.jsx)(j.Z,{label:"A\xe7ıklama",name:"description",value:d.description||"",onChange:I,fullWidth:!0,multiline:!0,rows:4,margin:"dense"})]}),(0,n.jsxs)(v.ZP,{item:!0,xs:12,md:6,children:[(0,n.jsx)(o.Z,{variant:"subtitle1",gutterBottom:!0,children:"\xdcr\xfcn Fotoğrafları"}),(0,n.jsxs)(s.Z,{..._(),sx:{border:"2px dashed grey",p:2,borderRadius:2,textAlign:"center",backgroundColor:U?"#f0f0f0":"inherit",cursor:"pointer"},children:[(0,n.jsx)("input",{...K()}),(0,n.jsx)(x.Z,{variant:"outlined",component:"span",startIcon:(0,n.jsx)(T.Z,{}),children:"Fotoğraf Se\xe7 veya S\xfcr\xfckleyip Bırak"}),(0,n.jsx)(o.Z,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"En fazla 15 adet. S\xfcr\xfckleyip bırakabilir veya tıklayarak se\xe7ebilirsiniz."})]}),(0,n.jsx)(s.Z,{sx:{display:"flex",flexWrap:"wrap",gap:2,mt:2},children:g.map((e,t)=>(0,n.jsxs)(s.Z,{sx:{position:"relative"},children:[(0,n.jsx)("img",{src:"string"==typeof e?e:e instanceof File?URL.createObjectURL(e):"/no-image.png",alt:"\xdcr\xfcn Fotoğrafı ".concat(t+1),width:100,height:100,style:{objectFit:"cover",borderRadius:8}}),(0,n.jsx)(c.Z,{size:"small",sx:{position:"absolute",top:0,right:0},onClick:()=>M(t),children:(0,n.jsx)(W.Z,{fontSize:"small"})})]},t))})]})]})}),(0,n.jsxs)(f.Z,{children:[(0,n.jsx)(x.Z,{onClick:a,children:"İptal"}),(0,n.jsx)(x.Z,{onClick:H,variant:"contained",children:l?"G\xfcncelle":"Kaydet"})]})]})},D=a(5482),F=a(1163),O=()=>{let{user:e}=(0,D.a)();(0,F.useRouter)();let[t,a]=(0,i.useState)([]),[v,C]=(0,i.useState)(!0),[S,P]=(0,i.useState)(null),[z,N]=(0,i.useState)(!1),[E,T]=(0,i.useState)(null),[W,A]=(0,i.useState)(!1),[O,I]=(0,i.useState)(""),[_,K]=(0,i.useState)([]),[U,M]=(0,i.useState)(!1);(0,i.useEffect)(()=>{R()},[e]);let R=async()=>{if(e)try{C(!0),P(null);let t=await e.getIdToken(),n=await fetch("http://localhost:5000/api/admin/products",{headers:{Authorization:"Bearer ".concat(t)}});if(!n.ok)throw Error("\xdcr\xfcnler y\xfcklenemedi.");let i=await n.json();a(i)}catch(e){P(e.message)}finally{C(!1)}},Y=async t=>{if(window.confirm("Bu \xfcr\xfcn\xfc silmek istediğinizden emin misiniz?"))try{let a=await e.getIdToken();if(!(await fetch("http://localhost:5000/api/admin/products/".concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(a)}})).ok)throw Error("\xdcr\xfcn silinemedi.");R()}catch(e){alert(e.message)}},H=e=>{T(t.find(t=>t.id===e)),N(!0)},G=()=>{N(!1),T(null)},J=async t=>{try{let a;let n=await e.getIdToken();if(!(a=t.id?await fetch("http://localhost:5000/api/admin/products/".concat(t.id),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(t)}):await fetch("http://localhost:5000/api/admin/products",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(t)})).ok){let e="\xdcr\xfcn kaydedilemedi.";try{let t=await a.json();t.error&&(e=t.error),t.fsError&&(e+=" (Dosya: "+t.fsError+")")}catch(e){}throw Error(e)}R(),G()}catch(e){alert(e.message)}},L=[{field:"images",headerName:"G\xf6rsel",width:80,renderCell:e=>e.value&&e.value.length>0?(0,n.jsx)(r.Z,{src:e.value[0],variant:"rounded"}):null,sortable:!1,filterable:!1},{field:"name",headerName:"\xdcr\xfcn Adı",flex:1,minWidth:200},{field:"category",headerName:"Kategori",width:150},{field:"price",headerName:"Fiyat",width:120,valueFormatter:e=>"₺".concat((Number(e.value)||0).toFixed(2))},{field:"stock",headerName:"Stok",width:120,valueGetter:e=>{let t=e.row.stock;return t?"object"==typeof t?Object.entries(t).map(e=>{let[t,a]=e;return"".concat(t,": ").concat(a)}).join(", "):t:""}},{field:"status",headerName:"Durum",width:160,renderCell:t=>{let i=t.row.stock,r=0;"object"==typeof i&&null!==i?r=Object.values(i).reduce((e,t)=>e+Number(t),0):"number"==typeof i&&(r=i);let c=!1!==t.row.isActive,d=r>0&&c?"Yayında":"Yayında Değil";return(0,n.jsxs)(s.Z,{display:"flex",alignItems:"center",gap:1,children:[(0,n.jsx)(l.Z,{checked:c,color:"success",size:"small",onChange:async n=>{let i=n.target.checked;try{let n=await e.getIdToken();await fetch("http://localhost:5000/api/admin/products/".concat(t.id),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({...t.row,isActive:i})}),a(e=>e.map(e=>e.id===t.id?{...e,isActive:i}:e))}catch(e){alert("Durum g\xfcncellenemedi: "+e.message)}}}),(0,n.jsx)(o.Z,{sx:{color:"Yayında"===d?"success.main":"error.main",fontWeight:"600",fontSize:14},children:d})]})}},{field:"actions",headerName:"İşlemler",width:150,sortable:!1,filterable:!1,renderCell:e=>(0,n.jsxs)(s.Z,{children:[(0,n.jsx)(c.Z,{onClick:()=>H(e.id),size:"small",color:"primary",children:(0,n.jsx)(y.Z,{})}),(0,n.jsx)(c.Z,{onClick:()=>Y(e.id),size:"small",color:"error",children:(0,n.jsx)(b.Z,{})})]})}];return v?(0,n.jsx)(w.Z,{pageTitle:"\xdcr\xfcnler",children:(0,n.jsx)(s.Z,{display:"flex",justifyContent:"center",alignItems:"center",sx:{height:400},children:(0,n.jsx)(d.Z,{})})}):S?(0,n.jsx)(w.Z,{pageTitle:"\xdcr\xfcnler",children:(0,n.jsx)(h.Z,{severity:"error",children:S})}):(0,n.jsxs)(w.Z,{pageTitle:"\xdcr\xfcnler",children:[(0,n.jsxs)(s.Z,{sx:{mb:2,display:"flex",justifyContent:"flex-end",gap:2},children:[(0,n.jsx)(x.Z,{variant:"contained",startIcon:(0,n.jsx)(k.Z,{}),onClick:()=>{T(null),N(!0)},children:"Yeni \xdcr\xfcn Ekle"}),(0,n.jsx)(x.Z,{variant:"outlined",color:"secondary",disabled:0===_.length,onClick:()=>A(!0),children:"İndirim"})]}),(0,n.jsx)(s.Z,{sx:{height:650,width:"100%",backgroundColor:"#fff",borderRadius:2},children:(0,n.jsx)(g._$,{rows:t,columns:L,pageSize:10,rowsPerPageOptions:[10,25,50],checkboxSelection:!0,disableSelectionOnClick:!0,components:{Toolbar:Z.n},getRowId:e=>e.id,rowSelectionModel:_,onRowSelectionModelChange:e=>K(e)})}),(0,n.jsx)(B,{open:z,onClose:G,onSave:J,product:E}),(0,n.jsxs)(u.Z,{open:W,onClose:()=>A(!1),children:[(0,n.jsx)(m.Z,{children:"İndirim Uygula"}),(0,n.jsx)(p.Z,{children:(0,n.jsx)(j.Z,{label:"İndirim Oranı (%)",type:"number",value:O,onChange:e=>I(e.target.value.replace(/[^0-9.]/g,"")),fullWidth:!0,inputProps:{min:1,max:99},sx:{mt:1}})}),(0,n.jsxs)(f.Z,{children:[(0,n.jsx)(x.Z,{onClick:()=>A(!1),children:"İptal"}),(0,n.jsx)(x.Z,{variant:"contained",color:"primary",disabled:!O||isNaN(Number(O))||0>=Number(O)||Number(O)>=100||U,onClick:async()=>{M(!0);try{let a=await e.getIdToken();for(let e of _){let n=t.find(t=>t.id===e);if(!n)continue;let i=Number(O),r=Number(n.price)*(1-i/100);await fetch("http://localhost:5000/api/admin/products/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({...n,discount:i,price:Number(r.toFixed(2))})})}A(!1),I(""),R()}catch(e){alert("İndirim uygulanamadı: "+e.message)}finally{M(!1)}},children:"Uygula"})]})]})]})}}},function(e){e.O(0,[22,390,723,345,541,716,873,770,916,573,793,230,592,118,888,774,179],function(){return e(e.s=2678)}),_N_E=e.O()}]);