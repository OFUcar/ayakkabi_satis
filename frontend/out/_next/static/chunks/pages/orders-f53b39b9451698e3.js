(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[660],{9501:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/orders",function(){return t(3242)}])},3242:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return D}});var s=t(5893),i=t(7294),n=t(990),l=t(7182),a=t(1032),c=t(6788),o=t(4723),d=t(8607),x=t(8907),h=t(762),u=t(1919),j=t(4677),p=t(8573),Z=t(1873),m=t(6912),y=t(3453),g=t(2365),v=t(110),f=t(3379),b=t(5770),S=t(7590),w=t(5895),k=t(2200),A=t(6727),C=t(703),B=t(8155),I=t(9203),P=t(8148),_=t(2944),z=t(9122),T=t(6578),E=t(5482),N=t(1163);function D(){var e;let{user:r,loading:t}=(0,E.a)(),D=(0,N.useRouter)(),[G,R]=(0,i.useState)([]),[W,q]=(0,i.useState)(!0),[F,H]=(0,i.useState)(0),[K,O]=(0,i.useState)(null),[X,L]=(0,i.useState)(!1),[Y,J]=(0,i.useState)(null);(0,i.useEffect)(()=>{t||r||D.push("/")},[r,t,D]),(0,i.useEffect)(()=>{r&&M()},[r]);let M=async()=>{try{q(!0);let e=await r.getIdToken();console.log("Siparişler fetch ediliyor, token:",e?"var":"yok");let t=await fetch("http://localhost:5000/api/orders",{headers:{Authorization:"Bearer ".concat(e)}});if(console.log("Sipariş response status:",t.status),t.ok){let e=await t.json();console.log("Siparişler başarıyla alındı:",e),R(e)}else{let e=await t.json();console.error("Sipariş fetch hatası:",e),J("Siparişler y\xfcklenirken hata oluştu")}}catch(e){console.error("Sipariş fetch catch hatası:",e),J("Siparişler y\xfcklenirken hata oluştu")}finally{q(!1)}},Q=e=>{O(e),L(!0)},U=()=>{L(!1),O(null)},V=e=>{switch(e){case"pending":return(0,s.jsx)(C.Z,{color:"warning"});case"shipped":return(0,s.jsx)(B.Z,{color:"info"});case"completed":return(0,s.jsx)(I.Z,{color:"success"});case"cancelled":return(0,s.jsx)(P.Z,{color:"error"});default:return(0,s.jsx)(_.Z,{})}},$=e=>{switch(e){case"pending":return"warning";case"shipped":return"info";case"completed":return"success";case"cancelled":return"error";default:return"default"}},ee=e=>{switch(e){case"pending":return"Beklemede";case"shipped":return"Kargoda";case"completed":return"Tamamlandı";case"cancelled":return"İptal Edildi";default:return e}},er=e=>new Date(e).toLocaleDateString("tr-TR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),et=e=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(e),es=G.filter(e=>"pending"===e.status||"shipped"===e.status),ei=G.filter(e=>"completed"===e.status||"cancelled"===e.status);return t?(0,s.jsx)(n.Z,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",children:(0,s.jsx)(l.Z,{})}):r?(0,s.jsxs)(a.Z,{maxWidth:"lg",sx:{py:4},children:[(0,s.jsx)(c.Z,{variant:"h4",component:"h1",gutterBottom:!0,children:"Siparişlerim"}),Y&&(0,s.jsx)(o.Z,{severity:"error",sx:{mb:2},onClose:()=>J(null),children:Y}),(0,s.jsx)(n.Z,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:(0,s.jsxs)(d.Z,{value:F,onChange:(e,r)=>{H(r)},children:[(0,s.jsx)(x.Z,{label:"Aktif Siparişler (".concat(es.length,")"),icon:(0,s.jsx)(C.Z,{}),iconPosition:"start"}),(0,s.jsx)(x.Z,{label:"Ge\xe7miş Siparişler (".concat(ei.length,")"),icon:(0,s.jsx)(I.Z,{}),iconPosition:"start"})]})}),W?(0,s.jsx)(n.Z,{display:"flex",justifyContent:"center",py:4,children:(0,s.jsx)(l.Z,{})}):(0,s.jsxs)(n.Z,{children:[0===F&&(0,s.jsx)(n.Z,{children:0===es.length?(0,s.jsx)(h.Z,{children:(0,s.jsxs)(u.Z,{sx:{textAlign:"center",py:4},children:[(0,s.jsx)(_.Z,{sx:{fontSize:64,color:"text.secondary",mb:2}}),(0,s.jsx)(c.Z,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"Aktif siparişiniz bulunmuyor"}),(0,s.jsx)(c.Z,{variant:"body2",color:"text.secondary",mb:3,children:"Hen\xfcz bir sipariş vermediniz veya t\xfcm siparişleriniz tamamlandı"}),(0,s.jsx)(j.Z,{variant:"contained",onClick:()=>D.push("/"),children:"Alışverişe Başla"})]})}):(0,s.jsx)(p.ZP,{container:!0,spacing:3,children:es.map(e=>{var r;return(0,s.jsx)(p.ZP,{item:!0,xs:12,children:(0,s.jsx)(h.Z,{children:(0,s.jsxs)(u.Z,{children:[(0,s.jsxs)(n.Z,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2,children:[(0,s.jsxs)(n.Z,{children:[(0,s.jsxs)(c.Z,{variant:"h6",gutterBottom:!0,children:["Sipariş #",e.id.slice(-8)]}),(0,s.jsx)(c.Z,{variant:"body2",color:"text.secondary",children:er(e.createdAt)})]}),(0,s.jsxs)(n.Z,{display:"flex",alignItems:"center",gap:1,children:[V(e.status),(0,s.jsx)(Z.Z,{label:ee(e.status),color:$(e.status),size:"small"})]})]}),(0,s.jsx)(m.Z,{sx:{my:2}}),(0,s.jsxs)(n.Z,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,s.jsxs)(n.Z,{children:[(0,s.jsxs)(c.Z,{variant:"body2",color:"text.secondary",children:[(null===(r=e.items)||void 0===r?void 0:r.length)||0," \xfcr\xfcn"]}),(0,s.jsx)(c.Z,{variant:"h6",color:"primary",children:et(e.total)})]}),(0,s.jsx)(j.Z,{variant:"outlined",startIcon:(0,s.jsx)(z.Z,{}),onClick:()=>Q(e),children:"Detayları G\xf6r"})]})]})})},e.id)})})}),1===F&&(0,s.jsx)(n.Z,{children:0===ei.length?(0,s.jsx)(h.Z,{children:(0,s.jsxs)(u.Z,{sx:{textAlign:"center",py:4},children:[(0,s.jsx)(T.Z,{sx:{fontSize:64,color:"text.secondary",mb:2}}),(0,s.jsx)(c.Z,{variant:"h6",color:"text.secondary",children:"Ge\xe7miş siparişiniz bulunmuyor"})]})}):(0,s.jsx)(p.ZP,{container:!0,spacing:3,children:ei.map(e=>{var r;return(0,s.jsx)(p.ZP,{item:!0,xs:12,children:(0,s.jsx)(h.Z,{children:(0,s.jsxs)(u.Z,{children:[(0,s.jsxs)(n.Z,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2,children:[(0,s.jsxs)(n.Z,{children:[(0,s.jsxs)(c.Z,{variant:"h6",gutterBottom:!0,children:["Sipariş #",e.id.slice(-8)]}),(0,s.jsx)(c.Z,{variant:"body2",color:"text.secondary",children:er(e.createdAt)})]}),(0,s.jsxs)(n.Z,{display:"flex",alignItems:"center",gap:1,children:[V(e.status),(0,s.jsx)(Z.Z,{label:ee(e.status),color:$(e.status),size:"small"})]})]}),(0,s.jsx)(m.Z,{sx:{my:2}}),(0,s.jsxs)(n.Z,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,s.jsxs)(n.Z,{children:[(0,s.jsxs)(c.Z,{variant:"body2",color:"text.secondary",children:[(null===(r=e.items)||void 0===r?void 0:r.length)||0," \xfcr\xfcn"]}),(0,s.jsx)(c.Z,{variant:"h6",color:"primary",children:et(e.total)})]}),(0,s.jsx)(j.Z,{variant:"outlined",startIcon:(0,s.jsx)(z.Z,{}),onClick:()=>Q(e),children:"Detayları G\xf6r"})]})]})})},e.id)})})})]}),(0,s.jsx)(y.Z,{open:X,onClose:U,maxWidth:"md",fullWidth:!0,children:K&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.Z,{children:(0,s.jsxs)(n.Z,{display:"flex",alignItems:"center",gap:1,children:[(0,s.jsx)(T.Z,{}),(0,s.jsxs)(c.Z,{variant:"h6",children:["Sipariş #",K.id.slice(-8)]})]})}),(0,s.jsx)(v.Z,{children:(0,s.jsxs)(n.Z,{sx:{pt:1},children:[(0,s.jsxs)(p.ZP,{container:!0,spacing:3,children:[(0,s.jsxs)(p.ZP,{item:!0,xs:12,md:6,children:[(0,s.jsx)(c.Z,{variant:"h6",gutterBottom:!0,children:"Sipariş Bilgileri"}),(0,s.jsxs)(n.Z,{sx:{mb:2},children:[(0,s.jsx)(c.Z,{variant:"body2",color:"text.secondary",children:"Sipariş Tarihi"}),(0,s.jsx)(c.Z,{variant:"body1",children:er(K.createdAt)})]}),(0,s.jsxs)(n.Z,{sx:{mb:2},children:[(0,s.jsx)(c.Z,{variant:"body2",color:"text.secondary",children:"Durum"}),(0,s.jsxs)(n.Z,{display:"flex",alignItems:"center",gap:1,children:[V(K.status),(0,s.jsx)(Z.Z,{label:ee(K.status),color:$(K.status),size:"small"})]})]}),(0,s.jsxs)(n.Z,{sx:{mb:2},children:[(0,s.jsx)(c.Z,{variant:"body2",color:"text.secondary",children:"Toplam Tutar"}),(0,s.jsx)(c.Z,{variant:"h6",color:"primary",children:et(K.total)})]})]}),(0,s.jsxs)(p.ZP,{item:!0,xs:12,md:6,children:[(0,s.jsx)(c.Z,{variant:"h6",gutterBottom:!0,children:"Teslimat Adresi"}),K.shippingAddress?(0,s.jsxs)(n.Z,{children:[(0,s.jsx)(c.Z,{variant:"body1",gutterBottom:!0,children:K.shippingAddress.title}),(0,s.jsx)(c.Z,{variant:"body2",color:"text.secondary",children:K.shippingAddress.fullAddress}),(0,s.jsxs)(c.Z,{variant:"body2",color:"text.secondary",children:[K.shippingAddress.district,", ",K.shippingAddress.city," ",K.shippingAddress.postalCode]})]}):(0,s.jsx)(c.Z,{variant:"body2",color:"text.secondary",children:"Adres bilgisi bulunamadı"})]})]}),(0,s.jsx)(m.Z,{sx:{my:3}}),(0,s.jsx)(c.Z,{variant:"h6",gutterBottom:!0,children:"Sipariş Edilen \xdcr\xfcnler"}),(0,s.jsx)(f.Z,{children:null===(e=K.items)||void 0===e?void 0:e.map((e,r)=>{var t,i,n,l,a,o;return(0,s.jsxs)(b.ZP,{sx:{px:0},children:[(0,s.jsx)(S.Z,{children:(0,s.jsx)(w.Z,{src:(null===(i=e.product)||void 0===i?void 0:null===(t=i.images)||void 0===t?void 0:t[0])||"/no-image.png",alt:null===(n=e.product)||void 0===n?void 0:n.name})}),(0,s.jsx)(k.Z,{primary:(null===(l=e.product)||void 0===l?void 0:l.name)||"\xdcr\xfcn bilgisi bulunamadı",secondary:"Adet: ".concat(e.quantity," | ").concat(et((null===(a=e.product)||void 0===a?void 0:a.price)||0))}),(0,s.jsx)(c.Z,{variant:"body1",color:"primary",children:et(((null===(o=e.product)||void 0===o?void 0:o.price)||0)*e.quantity)})]},r)})})]})}),(0,s.jsx)(A.Z,{children:(0,s.jsx)(j.Z,{onClick:U,children:"Kapat"})})]})})]}):null}}},function(e){e.O(0,[22,390,723,345,873,770,573,793,515,986,888,774,179],function(){return e(e.s=9501)}),_N_E=e.O()}]);